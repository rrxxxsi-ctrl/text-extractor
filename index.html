    <script>
        // --- 1. حل مشكلة شاشة التحميل (الحل الجذري) ---
        // سيتم إخفاء الشاشة فور تحميل الصفحة، أو بعد 2.5 ثانية كحد أقصى (إجباري)
        function hideLoader() {
            const loader = document.getElementById('loader');
            if (loader) {
                loader.style.opacity = '0';
                setTimeout(() => {
                    loader.style.display = 'none'; // إخفاء كامل من الصفحة
                }, 500);
            }
        }

        window.addEventListener('load', hideLoader);
        // مؤقت احتياطي: إذا لم يحمل الموقع خلال 2.5 ثانية، اخفِ الشاشة فوراً
        setTimeout(hideLoader, 2500);


        // --- 2. Particles Generator (خلفية الجزيئات) ---
        const particlesContainer = document.getElementById('particles');
        if (particlesContainer) {
            for (let i = 0; i < 20; i++) {
                const p = document.createElement('div');
                p.classList.add('particle');
                p.style.left = Math.random() * 100 + '%';
                p.style.top = Math.random() * 100 + '%';
                p.style.width = p.style.height = (Math.random() * 5 + 2) + 'px';
                p.style.animationDelay = (Math.random() * 5) + 's';
                p.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particlesContainer.appendChild(p);
            }
        }

        // --- 3. 3D Tilt Effect ---
        function tilt(e, card) {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            const xCenter = rect.width / 2;
            const yCenter = rect.height / 2;
            
            const rotateX = ((y - yCenter) / yCenter) * -5;
            const rotateY = ((x - xCenter) / xCenter) * 5;

            card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
        }

        function resetTilt(card) {
            card.style.transform = `perspective(1000px) rotateX(0) rotateY(0) scale(1)`;
        }

        // --- 4. Translations & Logic ---
        const i18n = {
            ar: {
                certified: "مكتب معتمد", office_name: "مكتب بدر الحقيل", real_estate: "للعقارات",
                desc: "بوابتك الموثوقة لتصحيح أوضاع المباني السكنية والتجارية",
                res_title: "المسار السكني", com_title: "المسار التجاري",
                r_step1: "رفع المقاسات", r_desc1: "معاينة دقيقة على الطبيعة",
                r_step2: "مخطط الوضع القائم", r_desc2: "رسم هندسي للواقع",
                r_step3: "إنشاء مخطط مقترح", r_desc3: "تصميم التعديلات المطلوبة",
                r_step4: "إعداد تقرير فني", r_desc4: "تقرير معتمد وشامل",
                r_step5: "إرسال للبلدية", r_desc5: "متابعة حتى الاعتماد",
                c_step1: "رفع المقاسات", c_desc1: "مطابقة دقيقة للواقع",
                c_step2: "مخطط الوضع القائم", c_desc2: "رسم تفصيلي دقيق",
                c_step3: "مخطط مقترح", c_desc3: "تعديلات معمارية تجارية",
                c_step4: "تقرير فني", c_desc4: "السلامة الإنشائية",
                c_step5: "واجهة 3D", c_desc5: "تصميم واجهة عصرية",
                c_step6: "إرسال للأمانة", c_desc6: "متابعة المعاملة بالكامل"
            },
            en: {
                certified: "Certified Office", office_name: "Bader Al Huqail", real_estate: "Real Estate",
                desc: "Your trusted gateway for Residential & Commercial building correction",
                res_title: "Residential", com_title: "Commercial",
                r_step1: "Site Measurements", r_desc1: "Precise on-site inspection",
                r_step2: "As-Built Drawing", r_desc2: "Current status plan",
                r_step3: "Proposal Plan", r_desc3: "Design required changes",
                r_step4: "Technical Report", r_desc4: "Comprehensive certified report",
                r_step5: "Submit to Municipality", r_desc5: "Follow-up until approval",
                c_step1: "Site Measurements", c_desc1: "Exact reality matching",
                c_step2: "As-Built Drawing", c_desc2: "Detailed engineering plan",
                c_step3: "Proposal Plan", c_desc3: "Commercial architectural edits",
                c_step4: "Technical Report", c_desc4: "Structural safety proof",
                c_step5: "3D Facade", c_desc5: "Modern design",
                c_step6: "Submit to Municipality", c_desc6: "Complete procedure follow-up"
            }
        };

        let lang = 'ar';
        function toggleLang() {
            lang = lang === 'ar' ? 'en' : 'ar';
            const html = document.documentElement;
            const btn = document.getElementById('lang-btn');
            
            if (lang === 'en') {
                html.setAttribute('dir', 'ltr');
                html.setAttribute('lang', 'en');
                btn.textContent = 'عربي';
            } else {
                html.setAttribute('dir', 'rtl');
                html.setAttribute('lang', 'ar');
                btn.textContent = 'EN';
            }
            
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (i18n[lang][key]) el.innerHTML = i18n[lang][key];
            });
        }

        let isLight = false;
        function toggleTheme() {
            isLight = !isLight;
            document.body.classList.toggle('light-mode');
            const icon = document.querySelector('#theme-btn i');
            icon.className = isLight ? 'fa-solid fa-moon' : 'fa-regular fa-sun';
        }

        function openMap(e) {
            e.preventDefault();
            const btn = document.getElementById('map-btn');
            btn.classList.add('shake-active');
            setTimeout(() => {
                btn.classList.remove('shake-active');
                window.location.href = "https://maps.app.goo.gl/R61NfEcdJApitWE59";
            }, 500);
        }
    </script>
    
