<script>
    const dictionary = {
        ar: {
            langLabel: "EN", 
            title: "مكتب بدر الحقيل للعقارات", 
            subtitle: "الدليل الشامل لتصحيح وضع المباني وإصدار رخصة البناء",
            ctaText: "هل أنت جاهز لتصحيح وضع عقارك؟",
            ctaBtn: "ابدأ معاملتك الآن", 
            resTab: "المسار السكني", 
            comTab: "المسار التجاري",
            call: "اتصال", wa: "واتساب", loc: "الموقع",
            uiFeaturesTitle: "لماذا تختار مكتب بدر الحقيل؟",
            feat1T: "الاعتماد", feat1D: "استشارات هندسية معتمدة وخبرة في التعامل مع كود البناء السعودي.",
            feat2T: "المصداقية", feat2D: "نعمل بمسؤولية تامة لضمان قبول ملفك لدى الجهات المختصة.",
            feat3T: "دقة المواعيد", feat3D: "نلتزم بالجدول الزمني المحدد لإنهاء إجراءاتك في أسرع وقت.",
            data: {
                common: [
                    { t: "1. تقديم الطلب", d: "بدء المعاملة وتجهيز ملف ورقي وإلكتروني كامل للمبنى القائم." },
                    { t: "2. التعريف", d: "تحديد الموقع، المساحة، ونوع النشاط بدقة قبل بدء العمل الميداني." }
                ],
                res: [
                    { t: "3. رفع المقاسات", d: "زيارة الموقع ورفع الأبعاد الفعلية للمبنى القائم لضمان المطابقة." },
                    { t: "4. مخطط الوضع القائم", d: "رسم هندسي دقيق يوثق الحالة الراهنة للمبنى والمساحات المشغولة." },
                    { t: "5. إنشاء مخطط مقترح", d: "تجهيز الرسومات الهندسية الجديدة اللازمة لتصحيح الوضع نظامياً." },
                    { t: "6. إنشاء تقرير فني", d: "تقرير معتمد يثبت السلامة الإنشائية للمبنى ومطابقته للأكواد." },
                    { t: "7. الإرسال للبلدية", d: "المرحلة النهائية لإرسال المعاملة إلى البلدية الفرعية لإصدار الرخصة." }
                ],
                com: [
                    { t: "3. الرفع والتوثيق الميداني", d: "رفع مساحي دقيق للمنشأة التجارية وتحديد المساحات المستغلة." },
                    { t: "4. الدراسة الفنية", d: "إعداد المخططات والتقارير الهندسية اللازمة للمنشآت التجارية." },
                    { t: "5. مخطط السلامة", d: "تجهيز مخططات الأمن والسلامة المعتمدة من قبل الدفاع المدني." },
                    { t: "6. تصميم واجهة 3D", d: "تصوير مرئي لترميز واجهات المبنى بما يتوافق مع هوية الأمانة." },
                    { t: "7. الإرسال للأمانة", d: "رفع المعاملة مباشرة للأمانة لمراجعة المتطلبات وإصدار الرخصة." }
                ]
            }
        },
        en: {
            langLabel: "AR", 
            title: "Bader Al-Hogail Real Estate", 
            subtitle: "Building Status Correction & Licensing Guide",
            ctaText: "Ready to correct your property status?",
            ctaBtn: "Start Now", 
            resTab: "Residential", 
            comTab: "Commercial",
            call: "Call", wa: "WhatsApp", loc: "Location",
            uiFeaturesTitle: "Why Choose Bader Al-Hogail?",
            feat1T: "Accreditation", feat1D: "Certified engineering consultancy with SBC expertise.",
            feat2T: "Credibility", feat2D: "We ensure your file's official approval by authorities.",
            feat3T: "Punctuality", feat3D: "Committed to strict schedules for record-time processing.",
            data: {
                common: [
                    { t: "1. Request Submission", d: "Starting the process and preparing documentation." },
                    { t: "2. Definition", d: "Identifying location, area, and activity type accurately." }
                ],
                res: [
                    { t: "3. Site Survey", d: "Physical visit for laser-accurate dimensions." },
                    { t: "4. As-Built Plan", d: "Engineering drawing documenting current building state." },
                    { t: "5. Proposed Plan", d: "Preparing drawings required for legal correction." },
                    { t: "6. Technical Report", d: "Certified report proving structural safety." },
                    { t: "7. Send to Municipality", d: "Final stage for license issuance." }
                ],
                com: [
                    { t: "3. Survey & Documentation", d: "Precise survey of commercial facilities." },
                    { t: "4. Technical Study", d: "Preparing specialized plans for commercial units." },
                    { t: "5. Safety Plan", d: "Creating plans approved by Civil Defense." },
                    { t: "6. 3D Design", d: "Visual facade concepts matching urban identity." },
                    { t: "7. Send to Amanah", d: "Submitting to Main Amanah for final approval." }
                ]
            }
        }
    };

    let currentLang = 'ar';
    let currentTrack = 'res';
    let isDarkMode = true;

    function toggleTheme() {
        isDarkMode = !isDarkMode;
        document.body.classList.toggle('light-mode');
        const icon = document.getElementById('theme-icon');
        const logo = document.getElementById('main-logo');
        icon.className = isDarkMode ? 'fa-solid fa-moon' : 'fa-solid fa-sun';
        logo.src = isDarkMode ? 'https://d.top4top.io/p_3660ar88q0.jpg' : 'https://d.top4top.io/p_3660ltd8v0.jpg';
    }

    function toggleLanguage() {
        currentLang = (currentLang === 'ar') ? 'en' : 'ar';
        document.documentElement.dir = (currentLang === 'ar') ? 'rtl' : 'ltr';
        const t = dictionary[currentLang];
        
        // تحديث النصوص الثابتة
        document.getElementById('lang-label').innerText = t.langLabel;
        document.getElementById('ui-title').innerText = t.title;
        document.getElementById('ui-subtitle').innerText = t.subtitle;
        document.getElementById('ui-cta-text').innerText = t.ctaText;
        document.getElementById('ui-cta-btn').innerText = t.ctaBtn;
        document.getElementById('res-btn').innerText = t.resTab;
        document.getElementById('com-btn').innerText = t.comTab;
        document.getElementById('ui-dock-call').innerText = t.call;
        document.getElementById('ui-dock-wa').innerText = t.wa;
        document.getElementById('ui-dock-loc').innerText = t.loc;
        document.getElementById('ui-features-title').innerText = t.uiFeaturesTitle;
        document.getElementById('feat-1-t').innerText = t.feat1T;
        document.getElementById('feat-1-d').innerText = t.feat1D;
        document.getElementById('feat-2-t').innerText = t.feat2T;
        document.getElementById('feat-2-d').innerText = t.feat2D;
        document.getElementById('feat-3-t').innerText = t.feat3T;
        document.getElementById('feat-3-d').innerText = t.feat3D;

        renderContent();
    }

    function switchTrack(track) {
        currentTrack = track;
        document.getElementById('res-btn').classList.toggle('active', track === 'res');
        document.getElementById('com-btn').classList.toggle('active', track === 'com');
        renderContent();
    }

    function renderContent() {
        const container = document.getElementById('steps-container');
        container.innerHTML = '';
        const dict = dictionary[currentLang];
        
        // دمج الخطوات المشتركة مع المسار المختار
        const allSteps = [...dict.data.common, ...dict.data[currentTrack]];
        
        allSteps.forEach((step, index) => {
            const card = document.createElement('div');
            card.className = 'step-card';
            const alignmentClass = currentLang === 'ar' ? 'text-right' : 'text-left';
            
            // إصلاح الرقم: نأخذ الرقم الموجود قبل النقطة في النص
            const parts = step.t.split('.');
            const num = parts[0];
            const title = parts[1] || step.t;

            card.innerHTML = `
                <div class="step-num">${num}</div>
                <div class="flex-1 ${alignmentClass}">
                    <h3 class="text-md font-bold mb-1">${title}</h3>
                    <p class="text-xs text-gray-400 font-medium leading-relaxed">${step.d}</p>
                </div>`;
            container.appendChild(card);
            setTimeout(() => card.classList.add('show'), index * 100);
        });
    }

    window.onload = renderContent;
</script>
